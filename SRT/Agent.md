# SRT 專案核心 Agent 作業規範 (Agent.md)

## 文件版本
- **版本號：** v2.1 (專業知識補充插入規範強化版)
- **更新日期：** 2026-01-08
- **目標：** 確保 SRT 字幕處理、檢查、與合併轉製逐字稿的流程絕對標準化且無錯誤。

---

# 🛑 核心鐵律 (CRITICAL RULES)

1. **零省略原則 (Zero Omission Policy)**：
   - 在執行「合併」或「轉逐字稿」任務時，**嚴禁**對內容進行摘要、總結或改寫。
   - 原始音訊所轉錄的每一個句子（除了純粹的語助詞外）都必須完整保留。
   - **禁止**使用「講者介紹了...」、「第一部分提到...」這種第三人稱描述性寫法。必須保留第一人稱的原話。

2. **嚴格的「整理」定義**：
   - 「整理」僅指：移除時間軸、移除贅字、合併破碎斷行、加入 Markdown 標題、插入專業知識補充。
   - 「整理」**絕不包含**：刪減句子、濃縮段落、改變語氣。

3. **操作前確認**：
   - 修改檔案前，必須閱讀 `Agent.md` 確認當前任務的規範。
   - 輸出的檔案必須另存新檔，嚴禁覆寫原始 SRT。

---

# 📚 任務一：SRT 資料合併與逐字稿生成 (Transcript Merging)

當用戶指令涉及「合併」、「逐字稿」、「去除時間軸」時，必須嚴格遵守本流程。

## 1. 執行標準 (Standard of Execution)

### A. 輸入處理
- 讀取所有指定的 SRT 檔案（如 `5-1.srt`, `5-2.srt`...）。
- 按檔案名稱順序（或指定邏輯順序）串接內容。

### B. 內容清理規則 (Cleaning Rules)
1. **移除元數據**：刪除所有的 SRT 序號（1, 2, 3...）與時間軸（00:00:00...）。
2. **移除贅字 (Stop Words Removal)**：
   - 移除無意義的停頓詞：`那個`、`呃`、`嗯`、`就`、`那` (當作發語詞時)、`好的` (當作無意義轉場時)。
   - **注意**：若刪除會影響句意（例如「那個東西」的「那個」），則必須保留。
3. **段落重組 (Paragraphing)**：
   - 將 SRT 的短行合併為通順的長段落。
   - 避免出現過長的「文字塊」，適當依據語意分段（建議每 300-500 字或話題轉換時分段）。

### C. 排版與標題 (Formatting & Headings)
- **插入標題**：根據內文邏輯，插入 `##` 或 `###` 標題。
  - **重要**：標題是「插入」在段落之間，**不能**用標題來取代原本的內文。
- **連接詞修飾**：若合併處語氣不順，可極少量加入連接詞（如：接著、然後），但不得改變原意。

### D. 專業知識補充 (Knowledge Supplement) - **(重點規範)**
- **定義**：將文中出現的專業術語（如 Transformer, Logit Lens, SAE...）提取出來進行解釋。
- **插入位置**：
  - **必須**插入在逐字稿中**首次或主要談到該專業知識的段落之後**。
  - **嚴禁**將所有補充統一放在文末。必須「隨文補充」，讓讀者在閱讀到該概念時能立即獲得解釋。
- **格式規範**：
  - 使用 Markdown 引用區塊 `> ` 進行標示。
  - 標題格式：`> **專業知識補充：[術語名稱] ([中文翻譯])**`。
  - 內容格式：`> [解釋內容]`。
  - **間距要求**：補充區塊的**上方**與**下方**必須各保留**一個空行**，以區隔正文。
- **範例**：
  ```markdown
  (正文段落)...這就是我們今天要討論的 Transformer 架構。
  
  > **專業知識補充：Transformer**
  > 
  > 現代 LLM 的核心架構，完全依賴注意力機制（Attention）來處理序列數據。
  
  (正文段落)接下來，我們來看看 Transformer 的細節...
  ```

## 2. 錯誤樣態對照表 (Failure Modes)

| 錯誤類型 | 錯誤範例 (❌) | 正確範例 (✅) |
| :--- | :--- | :--- |
| **摘要化 (Summarization)** | "講者介紹了 Transformer 的架構。" | "接下來，我想來回顧一下，Transformer 到底是一種什麼樣的模型。" (保留原話) |
| **第三人稱描述** | "第一部分討論了分析方法。" | "首先，關於「內部行為觀察」，我想先介紹一些案例..." (保留原話) |
| **補充位置錯誤** | (所有術語解釋都放在文件最後面的 Glossary 章節) | (術語解釋插入在文中提到該術語的段落正下方) |
| **省略細節** | (刪除了講者舉例的細節，只留結論) | (完整保留講者舉例的所有過程與細節) |
| **過度清洗** | (刪除了「我覺得」、「我認為」等語氣詞) | (保留適度的語氣詞以維持現場感，僅刪除無意義贅字) |

## 3. 最終檢查清單 (Final Checklist)
- [ ] 是否保留了所有教學內容與細節？
- [ ] 是否移除了時間軸與序號？
- [ ] 是否移除了「呃、那個」等贅字？
- [ ] 是否加入了適當的標題？
- [ ] 是否**沒有**將內容轉寫為摘要或文章體裁？
- [ ] **是否將專業知識補充插入在文中對應位置，而非文末？**
- [ ] **補充區塊上下是否都保留了空行？**

---

# 🛠️ 任務二：SRT 檔案品質檢查與修正 (QA/QC)

當用戶指令涉及「檢查 SRT」、「修正時間軸」、「格式錯誤」時，適用本規範。

## 1. 檢查規範 (Inspection Rules)
- **獨立性**：每個檔案視為獨立任務，清除前次記憶。
- **零改動文字**：僅修正時間軸與序號，**嚴禁**修改字幕文字內容。

## 2. 修正流程 (Correction Protocol)
1. **清理 (Clean)**：提取 `[\d:,]`，過濾髒字符（如 `ms`, `周4`）。
2. **正規化 (Normalize)**：補齊為 `HH:MM:SS,mmm`（毫秒補足3位）。
3. **邏輯修復**：
   - 修正分鐘循環（如 00:59:00 -> 00:00:00 的錯誤）。
   - 確保 `Start Time < End Time`。
   - 確保 `Next Start >= Previous End`。

## 3. 檔案交付
- **另存新檔**：`filename_fixed.srt`。
- **保留原檔**：不得覆寫原始 SRT。

---

# 📝 檔案命名與輸出規範

- **合併逐字稿**：建議命名為 `[課程名稱/章節]_完整逐字稿.md`。
- **修正後 SRT**：命名為 `[原檔名]_fixed.srt`。
- **編碼**：統一使用 UTF-8。

---

**版本控管：** v2.1
**最後更新：** 2026-01-08